\chapter{Cross-Plattform-Entwicklung mit Xamarin}
  Xamarin ist 2011 infolge der Entlassung des früheren Teams zur Entwicklung von Mono durch Novell entstanden.
Es ist ein unabhängiges Unternehmen, das allerdings eng mit Microsofts .NET-Team zusammenarbeitet.
Im Zuge dieser 
 Partnerschaft werden Visual-Studio-Entwickler 
durch Xamarins Produkte zur Entwicklung von Apps für iOS und Android unterstützt. Außerdem können
MSDN-Abonnenten kostenlos auf den Kurs Xamarin University zugreifen, der dabei helfen soll,
innerhalb kurzer Zeit zum Experten der Xamarin-Tools zu werden [\cite{MX}].
\\Das Entwickeln in einer einheitlichen Programmiersprache ist nicht der einzige Vorteil von
Xamarin.
 Xamarin.Forms ist ein mächtiges Feature, mit dem man nicht nur die Anwendung in C\# entwickeln
 kann, sondern auch den größten Teil des Codes gemeinsam für alle drei Zielplattformen nutzen
 kann. Man kann mit Xamarin.Forms in einem Projekt gleichzeitig für iOS, Android und Windows Phone
 entwickeln und alle drei Produkte haben am Ende bis zu 70\% gemeinsamen Code und nur 30\%
 plattformspezifischen Code.

\section{Getting Started mit Xamarin}
Um Xamarin benutzen zu können, braucht man ein kostenpflichtiges Benutzerkonto (Account). Es gibt
verschiedene Arten von Accounts, die mit unterschiedlichen Features verbunden sind.
\begin{itemize} 
  \item \textbf{Indie Account} (\$25 im Monat).\\Studenten können es kostenlos
  beantragen. Im Paket ist die Entwicklungsumgebung von Xamarin, das Xamarin Studio, enthalten.
  Xamarin.iOS und Xamarin.Android kommen ebenso mit dem Indie Account mit, sowie das
  plattformübergreifende Werkzeug, Xamarin.Forms. Man kann mit diesem Account noch
  Anwendungen in die verschiedenen App-Märkte deployen.
  \item \textbf{Business Account} (\$83 im Monat).\\Wer professionell Xamarin Apps entwickeln
  möchte, kommt an den Business Account nicht herum. In diesem Benutzerkonto sind alle Features von Indie enthalten
  plus zusätzliche Business Features und das wichtigste, Visual Studio Einbindung und privates Email Support von Xamarin Experten.
  \item \textbf{Enterprise Account} (\$158 im Monat).\\Im Enterprise Account sind viele weitere
  Features enthalten, wie z.B. die Anbindung einer verschlüsselten lokalen Datenbank.
\end{itemize}
Bevor mit der App Entwicklung mit Xamarin angefangen werden kann, müssen einige Voraussetzungen
erfüllt werden.\\Für die Entwicklung von iOS- oder Mac OS X-Apps, wird ein Mac
Rechner vorausgesetzt.
Auf einem Mac kann mit Xamarin Studio, mittels Xamarin.iOS und Xamarin.Android,
plattformübergreifend für iOS und Android entwickelt werden. Es reichen ein Mac Rechner und ein
Xamarin Indie Account.
\\Auf einem Windows PC kann man nur für Android und Windows Phone entwickeln. Eventuell
kann man einen Mac Rechner als Build Server (Macintosh Build Host mit Apples SDK) benutzen, um unter
Windows Apps für iOS entwickeln zu können (siehe Abb.\ref{fig:abb16}).
Dafür ist allerdings mindestens Xamarin Business Account erforderlich.
\\Um für die drei meist verbreiteten mobilen Betriebssystemen
(Android, iOS und Windows Phone) plattformübergreifend entwickeln zu können, werden zwei Rechner
(ein Mac und ein Windows PC) und den Xamarin Business Account benötigt. Mit dem Business Account
lässt sich Xamarin als Plugin in Visual Studio einbinden.
\begin{figure}[!h]
\centering
\includegraphics[scale = 0.3]{graphics/Macintosh_Build_Host.png}
\caption{Xamarin unter Windows mit einem Macintosh Build Server [\cite{XiOS}]}
\label{fig:abb16}
\end{figure}

\newpage
\section{Xamarin Bibliotheken}
Im Folgenden werden die drei wichtigsten Bibliotheken von Xamarin vorgestellt. 
Mit Xamarin.iOS bzw. Xamarin.Android erstellte Programme stehen nativen Anwendungen in nichts nach
und können problemlos in App Store bzw. Play Store eingestellt werden. Da es sich sehr der nativen
App-Programmierung ähnelt, ist der Einstieg in Xamarin.iOS und Xamarin.Android reibungslos für
erfahrene Entwickler. Im Gegensatz zu der üblichen App Entwicklung, bei der
unterschiedliche Programmiersprachen (Objective-C und Java) verwendet werden, wird bei Xamarin.iOS
und Xamarin.Android ausschließlich C\# benutzt.
\\Die plattformübergreifende App-Entwicklung mit Xamarin geht noch weiter. Mit Xamarin.Forms lassen 
sich Apps für iOS, Android und Windows Phone mit gemeinsamen Code erstellen. Xamarin.Forms ist jedoch 
nicht für alle Typen von Anwendungen geeignet.
\subsection{Xamarin.iOS}
Mit Xamarin.iOS bietet Xamarin die Möglichkeit, native Apps für iOS zu entwickeln. Um Xamarin.iOS benutzen zu können,
wird Folgendes benötigt:
\begin{itemize}
  \item das aktuelle iOS SDK
  \item die letzte Version von Xcode
  \item Mac OS X 10.9.3+
\end{itemize}
Unter Mac OS werden Xamarin Apps mit der Entwicklungsumgebung Xamarin Studio entwickelt. Für das
Deployen und Testen einer iOS App auf einem mobilen Endgerät wird ein Apple Developer
Account vorausgesetzt. Dieser Account ist auch erforderlich, wenn man Apps in den App Store stellen
möchte.
\\Der Ahead-Of-Time (AOT) Compiler kompiliert Xamarin.iOS Apps direkt zu nativen ARM Assemblercode.
D.h. man kann mit Xamarin native iOS Apps erstellen. Xamarin.iOS ist eine Art Übersetzung der iOS
SDK von Apple in C\# mit .NET Namenskonventionen. Somit hat man Zugriff auf alle iOS APIs.
Mit einem automatisierten Binding-Generator ist auch die Benutzung von existierendem Objective-C
Code, sowie Frameworks und benutzerdefinierten Controls in einer Xamarin App möglich.\\Wenn iOS
Apps mittels Visual Studio auf einem Windows PC entwickelt werden, müssen die Apps auf dem
Macintosh Build Host simuliert werden, da es auf Windows keinen iOS Simulator gibt.

Xamarin.iOS App Entwicklung ist wie bereits erwähnt fast identisch mit der herkömmlichen iOS App
Entwicklung. Der Unterschied besteht grundsätzlich in der Programmiersprache. Es werden weiterhin
Grundtechnologien der iOS Entwicklung, wie Events, Protocols und Delegates benutzt. Xamarin.iOS
benutzt Delegates von Apple, die ähnlich der Delegates von C\# sind, aber anstatt die Definition und
Aufruf von einer einzigen Methode, ist ein Objective-C Delegate eine ganze Klasse, die einem
Protocol genügen soll. Ein Objective-C Protocol ist ähnlich wie ein C\# Interface, mit dem
Unterschied, dass die Methoden eines Protocols auch optional sein können.
Also Xamarin.iOS benutzt .NET Events mit UIKit Steuerelemente (Buttons, Labels,
Text Felder usw.).\\Xamarin.iOS stellt einen einen iOS UI-Designer zur Verfügung, mit dem die
Gestaltung der Benutzungsoberfläche auf die gleiche Art und Weise erfolgt, wie bei der iOS App
Entwicklung mit dem UI Builder von Xcode (siehe Abb.\ref{fig:abb17}). Der Xamarin Designer für iOS
ist enthalten in Xamarin Studio und lässt sich auch in Visual Studio integrieren. Das Tool
ermöglicht das Erstellen der Benutzungsoberfläche mithilfe Storyboards und stellt einen Mechanismus
zum programmatischen Zugriff auf UI Elemente bereit.
\begin{figure}[!h]
\centering
\includegraphics[scale = 0.215]{graphics/XamariniOS_UIBuilder.png}
\caption{Xamarin.iOS Interface Builder [\cite{XiOS}]}
\label{fig:abb17}
\end{figure}
\\Xamarin.iOS unterstützt den "`target-action style"' für die Bearbeitung eines Events, das durch
eine Interaktion ausgelöst wird. D.h. Xamarin.iOS
benutzt iOS Steuerelemente um .NET Ereignisse (Events) auszulösen.\\Beim Markieren eines
Steuerelements (z.B. Button) können unter Properties eine eindeutige Bezeichnung für das
Element, sowie andere Eigenschaften eingestellt werden (siehe Abb.\ref{fig:abb18}).
Um ein "`target-action"' für einen Button zu erstellen, muss lediglich auf den Button in dem iOS
Designer doppelgeklickt werden. Der Code des zuständigen UIViewControllers wird dann automatisch
angezeigt und der Entwickler wird aufgefordert auszuwählen, wo die Methode hinzugefügt werden soll, die beim
Vorkommen dieses Ereignisses aufgerufen wird.
\begin{figure}[!h]
\centering
\includegraphics[scale = 0.35]{graphics/buttonxs.png}
\caption{Properties eines Steuerelements [\cite{XiOS}]}
\label{fig:abb18}
\end{figure}
\\Xamarin.iOS unterstützt alle nativen Steuerelemente von Apple. Sie können zu einer Xamarin.iOS
Applikation hinzugefügt werden. Das kann mit dem iOS Designer, Xcodes Interface Builder oder
programmatisch passieren. Die meist verwendeten iOS UI Steuerelemente sind:
\begin{itemize}
  \item UILabel - "`read only"' Textfeld.
  \item UITextField - editierbares einzeiliges Textfeld.
  \item UITextView - editierbares mehrzeiliges Textfeld, mit Scrollfunktion.
  \item UIButton - klickbares Feld (Button).
  \item UISlider - Slider.
  \item UIImageView - Bild.
  \item UITableView - ein scrollbarer Container, der UITableViewCells beinhaltet.
  \item UITableViewCell - ein Viewelement, das eine Zeile in einer UITableView repräsentiert.
\end{itemize}
[\cite{XiOS}]
